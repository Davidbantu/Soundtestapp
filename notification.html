<!DOCTYPE html>
<html>
<head>
  <title>Kitchen Notification</title>
</head>
<body>
  <h1>Waiting for Orders...</h1>
  <button id="enableSound">Enable Notification Sound</button>
  <p id="status">Sound not enabled</p>

  <audio id="notifSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>

  <script>
    const channel = new BroadcastChannel('order_channel');
    const audio = document.getElementById('notifSound');
    const statusText = document.getElementById('status');
    let soundEnabled = false;

    // Unlock audio playback on user interaction
    document.getElementById('enableSound').addEventListener('click', () => {
      audio.currentTime = 0;
      audio.play().then(() => {
        soundEnabled = true;
        statusText.textContent = "ðŸ”Š Sound enabled. Ready for orders!";
        alert("Sound enabled. Notifications will play sound.");
      }).catch(err => {
        alert("Failed to enable sound: " + err);
      });
    });

    // Listen for orders
    channel.onmessage = (event) => {
      if (event.data === 'order_done') {
        alert("ðŸš¨ New Order Received!");
        if (soundEnabled) {
          audio.currentTime = 0;
          audio.play().catch(() => {});
        }
      }
    };
  </script>
</body>
</html>
